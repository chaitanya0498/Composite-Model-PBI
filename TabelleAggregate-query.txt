QUERY - tabelle aggregate

Tabella 'HOT'

SELECT [SK_project]
      ,[SK_gerarchia]
      ,A.[SK_Data]
      ,[SK_TD]
      ,[projectManagerID]
      ,[projectManager]
      ,[CostAmount]
      ,[RevenueAmount]
      ,[risorsaID]
      ,[risorsa]
      ,[workorder]
      ,A.[annomese]
      ,[lev2id]

FROM L2_F_HR_sperimentazione_PBI AS A    

INNER JOIN L2_Alten_D_Tempo AS B      
ON  A.SK_Data = B.SK_Data      

WHERE                 
datefromparts(B.Anno, B.Mese, 1) >= GETDATE() - 120




Tabella 'COLD'

SELECT [SK_project]
      ,[SK_gerarchia]
      ,A.[SK_Data]
      ,[SK_TD]
      ,[projectManagerID]
      ,[projectManager]
      ,[CostAmount]
      ,[RevenueAmount]
      ,[risorsaID]
      ,[risorsa]
      ,[workorder]
      ,A.[annomese]
      ,[lev2id]

FROM L2_F_HR_sperimentazione_PBI AS A    

INNER JOIN L2_Alten_D_Tempo AS B      
ON  A.SK_Data = B.SK_Data      

WHERE                 
datefromparts(B.Anno, B.Mese, 1) < GETDATE() - 120





Tabella 'HOT' aggregata per PROJECT -- si potrebbe fare su PowerBI 


Tabella 'COLD' aggregata per PROJECT

SELECT   A.SK_Project,  
SUM(A.costAmount) AS Costo ,SUM(A.revenueAmount) AS Ricavo
FROM L2_Alten_F_HR AS A    
INNER JOIN L2_Alten_D_Tempo AS B      
ON  A.SK_Data = B.SK_Data      
 WHERE                 
datefromparts(B.Anno, B.Mese, 1) <= GETDATE() - 120 
group by A.SK_Project 


